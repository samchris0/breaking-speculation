Overview
--------
Adding a task / ingestion module (e.g., Celery) introduces multiple hard process boundaries. Each boundary separates responsibility, failure domains, and execution contexts.

High-Level Flow
---------------
Browser (Dash)
    -> HTTP request
FastAPI server process
    -> message enqueue
Message broker (Redis / RabbitMQ)
    -> task dispatch
Celery worker process(es)
    -> ingestion execution
External APIs / Database

Each arrow represents a strict process or network boundary with no shared memory.

Process Boundaries Explained
----------------------------

1. Browser (Dash) -> FastAPI
   - Boundary type: Network (HTTP)
   - Data: JSON request payload
   - Notes:
     * No shared state
     * All context must be included in the request
     * Failures are immediately visible to the user

2. FastAPI Server Process
   - Boundary type: Application process
   - Role:
     * Validate request
     * Normalize data
     * Dispatch background work
   - Should not perform heavy ingestion work

3. FastAPI -> Broker
   - Boundary type: Inter-process messaging
   - Data: Serialized task arguments
   - Notes:
     * Task is queued, not executed
     * Data must be serializable
     * No open DB sessions or API clients allowed

4. Broker (Queue)
   - Boundary type: Durable message storage
   - Role:
     * Persist tasks
     * Buffer load
     * Enable retries
   - Notes:
     * Tasks can survive crashes
     * Tasks may be delivered more than once

5. Broker -> Celery Worker
   - Boundary type: Separate OS process (often separate machine)
   - Role:
     * Deserialize task
     * Rebuild context
     * Execute ingestion logic
   - Notes:
     * Nothing is shared with FastAPI
     * All dependencies must be recreated

6. Celery Worker -> External APIs
   - Boundary type: Network / third-party systems
   - Notes:
     * Rate limits
     * Timeouts
     * Partial failures
     * Retries and backoff are essential

7. Celery Worker -> Database / Storage
   - Boundary type: Persistence
   - Role:
     * Store results
     * Track job status
     * Enable recovery and observability

Summary Table
-------------

Boundary                       | Purpose
-------------------------------|-------------------------------------------
Browser -> FastAPI             | User interaction
FastAPI process                | Validation and dispatch
FastAPI -> Broker              | Async decoupling
Broker                         | Durability and buffering
Broker -> Worker               | Parallel execution
Worker -> External APIs        | Data ingestion
Worker -> Database / Storage   | Persistent state

Key Mental Model
----------------
FastAPI dispatches work.
Celery performs work.
The broker remembers work.
The database remembers results.